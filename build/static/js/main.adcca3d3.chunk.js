(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){},111:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){},117:function(e,t,a){},119:function(e,t,a){},121:function(e,t,a){},123:function(e,t,a){},125:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(32),s=a.n(r),i=(a(42),a(35)),o=a(2),l=a(129),m=a(127),u=a(128),p=a(9),h=Object(p.a)(),d=Object(n.createContext)({}),g=Object(n.createContext)({}),f=a(3),v=a.n(f),E=function(e){return localStorage.setItem("token",e)},b=function(){return!!N()},N=function(){return localStorage.getItem("token")},j=function(){var e={headers:{Authorization:"Bearer "+y(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/users/self"),e).then(function(e){return e.data}).catch(function(e){return O()})},y=function(){return localStorage.getItem("token")},O=function(){return localStorage.removeItem("token")},w=(a(63),a(10)),k=a(6),I=a(126),A=(a(65),function(){var e=Object(n.useContext)(d),t=e.setAuth,a=e.auth.isAuth,r=Object(n.useContext)(g).setPlayer,s=Object(n.useState)({username:"",password:""}),i=Object(o.a)(s,2),l=i[0],m=i[1],p=function(e){m(Object(k.a)({},l,Object(w.a)({},e.target.name,e.target.value)))};return a?c.a.createElement(u.a,{to:"/game"}):c.a.createElement("div",{className:"loginBackground"},c.a.createElement("div",{className:"loginForm"},c.a.createElement("input",{name:"username",className:"input",value:l.username,onChange:p}),c.a.createElement("input",{name:"password",type:"password",className:"input",value:l.password,onChange:p}),c.a.createElement("div",{className:"button",onClick:function(){(function(e,t){var a={grant_type:"password",client_id:"2",client_secret:"YuMGy00bQjOewsIS2A9XNnvkkReoLNTpHWipAn3a",username:e,password:t};return v.a.post("".concat("http://82.202.212.131:8000","/oauth/token"),a).then(function(e){return E(e.data.access_token),e})})(l.username,l.password).then(function(e){j().then(function(e){t({isAuth:!0}),r(e),h.push("/game")})})}},"Login"),c.a.createElement(I.a,{to:"/register"},"Register")))}),C=(a(70),function(){var e=Object(n.useContext)(d),t=(e.setAuth,e.auth.isAuth),a=Object(n.useState)({username:"",email:"",password:""}),r=Object(o.a)(a,2),s=r[0],i=r[1],l=function(e){i(Object(k.a)({},s,Object(w.a)({},e.target.name,e.target.value)))};return t?c.a.createElement(u.a,{to:"/game"}):c.a.createElement("div",{className:"registerBackground"},c.a.createElement("div",{className:"registerForm"},c.a.createElement("input",{name:"email",className:"input",value:s.email,onChange:l}),c.a.createElement("input",{name:"username",className:"input",value:s.username,onChange:l}),c.a.createElement("input",{name:"password",type:"password",className:"input",value:s.password,onChange:l}),c.a.createElement("div",{className:"button",onClick:function(){console.log(s),function(e,t,a){var n={email:e,username:t,password:a};return v.a.post("".concat("http://82.202.212.131:8000","/api/users"),n).then(function(e){return e})}(s.email,s.username,s.password).then(function(e){h.push("/")})}},"Register"),c.a.createElement(I.a,{to:"/"},"Login")))}),_=a(33),x=a.n(_),L=a(34),S=a.n(L),B=function(){return localStorage.getItem("token")},K=(a(107),function(e){var t=e.user;return c.a.createElement("div",{className:"user"},c.a.createElement("span",{className:"circle"}),c.a.createElement("span",{className:"username"},t.name),c.a.createElement("span",{className:"level"},"[",t.level,"]"))}),F=[{name:"4Head",src:"assets/emotes/twitch/4head.0"},{name:"Kappa",src:"assets/emotes/twitch/Kappa.0"},{name:"OMEGALUL",src:"assets/emotes/twitch/OMEGALUL.0"},{name:"chompy",src:"assets/emotes/twitch/chompy.gif"},{name:"DatSheffy",src:"assets/emotes/twitch/DatSheffy.0"},{name:"KappaClaus",src:"assets/emotes/twitch/KappaClaus.0"},{name:"KappaPride",src:"assets/emotes/twitch/KappaPride.0"},{name:"KKomrade",src:"assets/emotes/twitch/KKomrade.png"},{name:"KKona",src:"assets/emotes/twitch/KKona.0"},{name:"LUL",src:"assets/emotes/twitch/LUL.0"},{name:"MingLee",src:"assets/emotes/twitch/MingLee.0"},{name:"PogChamp",src:"assets/emotes/twitch/PogChamp.0"},{name:"WutFace",src:"assets/emotes/twitch/WutFace.0"}],P=function(e){var t=e.message,a=t.text.split(" ").map(function(e,t){var a=[];return F.map(function(t){return t.name===e?a=t:null}),a.name===e?c.a.createElement(c.a.Fragment,{key:t},c.a.createElement("img",{alt:e,src:a.src})," "):c.a.createElement(c.a.Fragment,{key:t},e," ")});return c.a.createElement("div",{className:"message"},c.a.createElement("span",{className:"date"},x()(t.date).format("HH:mm")),c.a.createElement("span",{className:"username"},t.is_system?"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435":t.sender.name,":"),c.a.createElement("span",{className:"text"},a))},W=function(){var e=Object(n.useState)({isLoading:!0}),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)([]),i=Object(o.a)(s,2),l=i[0],m=i[1],u=Object(n.useState)([]),p=Object(o.a)(u,2),h=p[0],d=p[1],g=Object(n.useState)({text:""}),f=Object(o.a)(g,2),E=f[0],b=f[1],N=Object(n.useRef)();return Object(n.useEffect)(function(){var e=setInterval(function(){(function(){var e={headers:{Authorization:"Bearer "+B(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat"),e).then(function(e){return e.data})})().then(function(e){d(e),r({isLoading:!1})}),function(){var e={headers:{Authorization:"Bearer "+B(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat/users_online"),e).then(function(e){return e.data})}().then(function(e){m(e)})},1e3);return N.current=e,function(){clearInterval(N.current)}},[]),c.a.createElement("div",{className:"chat"},a.isLoading?c.a.createElement("div",{className:"loading"},"Loading..."):c.a.createElement(c.a.Fragment,null,c.a.createElement(S.a,{className:"messages"},h?h.map(function(e,t){return c.a.createElement(P,{key:t,message:e})}):null),c.a.createElement("div",{className:"users"},c.a.createElement("div",{className:"online"},"\u041e\u043d\u043b\u0430\u0439\u043d: ",l.length),l?l.map(function(e,t){return c.a.createElement(K,{key:t,user:e})}):null),c.a.createElement("div",null,c.a.createElement("div",{className:"inputBox"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e){var t={message:e},a={headers:{Authorization:"Bearer "+B(),Accept:"application/json"}};v.a.post("".concat("http://82.202.212.131:8000","/api/chat"),t,a).then(function(e){return e.data})}(E.text),b({text:""})}},c.a.createElement("input",{name:"text",className:"input",autoComplete:"off",value:E.text,onChange:function(e){b({text:e.target.value})}}))),c.a.createElement("div",{className:"buttonBox"}))))},z=(a(109),function(){var e,t=Object(n.useContext)(d).setAuth,a=Object(n.useContext)(g),r=a.player,s=a.setPlayer,i=Object(n.useRef)(),o=r.hp_current/r.hp_max*100;e=o<=19?"red":o<=45?"yellow":"green",Object(n.useEffect)(function(){var e=setInterval(function(){j().then(function(e){s(Object(k.a)({},r,{hp_current:e.hp_current,in_battle:e.in_battle}))})},3e3);return i.current=e,function(){clearInterval(i.current)}});return c.a.createElement("div",{className:"topBar"},c.a.createElement("div",{className:"player"},r.name," [",r.level,"]",c.a.createElement("div",{className:"hp","data-progress":r.hp_current+"/"+r.hp_max},c.a.createElement("span",{className:"current",style:{width:o+"%",backgroundColor:e}}))),c.a.createElement("div",null,"Wins: ",r.count_wins),c.a.createElement("div",null,"Loses: ",r.count_loses),c.a.createElement("div",null,c.a.createElement("a",{href:"/",onClick:function(){localStorage.removeItem("token"),t({auth:!1})}},"Logout")))}),R=(a(111),function(){return c.a.createElement("div",{className:"gameMenu"},"map")}),M=(a(113),function(e){var t=e.slot;return c.a.createElement("div",{className:t.className},c.a.createElement("img",{src:t.image,alt:t.name}))}),H=function(e){var t,a=e.player,n=e.target,r=a.hp_current/a.hp_max*100;t=r<=19?"red":r<=45?"yellow":"green";var s="/assets/items/",i=[{name:"helmet",className:"item itemHelmet",image:s+"/inventory/helmet.png",item:[]},{name:"armor",className:"item itemArmor",image:s+"/inventory/armor.png",item:[]},{name:"belt",className:"item itemBelt",image:s+"/inventory/belt.png",item:[]},{name:"pants",className:"item itemPants",image:s+"/inventory/pants.png",item:[]},{name:"main_hand",className:"item itemWeapon",image:s+"/inventory/main_hand.png",item:[]},{name:"off_hand",className:"item itemSubWeapon",image:s+"/inventory/off_hand.png",item:[]},{name:"gloves",className:"item itemGloves",image:s+"/inventory/gloves.png",item:[]},{name:"shoes",className:"item itemShoes",image:s+"/inventory/shoes.png",item:[]},{name:"earringOne",className:"item itemEarringOne",image:s+"/inventory/earring.png",item:[]},{name:"earringTwo",className:"item itemEarringTwo",image:s+"/inventory/earring.png",item:[]},{name:"ringOne",className:"item itemRingOne",image:s+"/inventory/ring.png",item:[]},{name:"ringTwo",className:"item itemRingTwo",image:s+"/inventory/ring.png",item:[]},{name:"necklace",className:"item itemNecklace",image:s+"/inventory/necklace.png",item:[]},{name:"bag",className:"item itemBag",image:s+"/inventory/bag.png",item:[]}];return c.a.createElement("div",{className:n?"character target":"character user"},c.a.createElement("div",null,a.name," [",a.level,"]"),c.a.createElement("div",{className:"hp","data-progress":a.hp_current+"/"+a.hp_max},c.a.createElement("span",{className:"current",style:{width:r+"%",backgroundColor:t}})),c.a.createElement("div",{className:"avatar"},c.a.createElement("img",{src:"/assets/avatars/"+a.avatar,alt:a.name})),c.a.createElement("div",{className:"slots"},i.map(function(e,t){return c.a.createElement(M,{key:t,slot:e})})))},T=(a(115),function(e){var t=e.room;return c.a.createElement("div",{className:"room",style:{left:t.x,top:t.y}},c.a.createElement("img",{src:"/assets/cities"+t.model,alt:t.name,onClick:e.changeLocation.bind(null,t.id)}))}),D=function(){var e=Object(n.useContext)(g),t=e.player,a=e.setPlayer,r=Object(n.useState)({background:null,width:500,height:268,isLoading:!0}),s=Object(o.a)(r,2),i=s[0],l=s[1],m=Object(n.useState)({}),u=Object(o.a)(m,2),p=u[0],h=u[1];Object(n.useEffect)(function(){t.location_id&&function(e){var t={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/locations/").concat(e),t).then(function(e){return e.data})}(t.location_id).then(function(e){h(e),l(Object(k.a)({},i,{isLoading:!1,exitButton:{}}))})},[t.location_id]);var d=p.rooms,f=function(e){(function(e,t){var a={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.put("".concat("http://82.202.212.131:8000","/api/users/").concat(e,"?update=location"),{location_id:t},a).then(function(e){return e.data})})(t.id,e).then(function(e){a(Object(k.a)({},t,{location_id:e.location_id,location:e.location}))})};return c.a.createElement("div",{className:"map",style:{width:i.width,height:i.height,backgroundImage:"url(/assets/cities"+p.background+")"}},p.location_id?c.a.createElement("div",{onClick:f.bind(null,1)},"Back"):null,i.isLoading?c.a.createElement("div",null,"Loading..."):c.a.createElement("div",{className:"location"},p.name,d?d.map(function(e,t){return c.a.createElement(T,{key:t,room:e,changeLocation:f})}):null))},G=function(){var e={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles"),e).then(function(e){return e.data})},U=function(){var e={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles/current"),e).then(function(e){return console.log(e),e.data})},J=(a(117),function(){var e=Object(n.useContext)(g),t=e.player,a=e.setPlayer,r=Object(n.useState)([]),s=Object(o.a)(r,2),i=s[0],l=s[1],m=Object(n.useRef)();Object(n.useEffect)(function(){G().then(function(e){l(e)});var e=setInterval(function(){G().then(function(e){l(e)})},5e3);return m.current=e,function(){clearInterval(m.current)}},[i]);var u=function(e){(function(e){var t={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.put("".concat("http://82.202.212.131:8000","/api/battles/").concat(e),{},t).then(function(e){return e.data})})(e).then(function(e){a(Object(k.a)({},t,{in_battle:!0}))})};return c.a.createElement("div",{className:"fights"},i?i.map(function(e,a){return c.a.createElement("div",{key:a},e.id," - ",e.user1.name," [",e.user1.level,"]"," ",e.user1.id===t.id?null:c.a.createElement("button",{onClick:u.bind(null,e.id)},"Fight"))}):null,c.a.createElement("button",{onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles"),{},e).then(function(e){return e.data})})().then(function(e){return console.log(e)})}},"Fight"))}),Q=(a(119),function(){var e=Object(n.useContext)(g).player,t=Object(n.useState)({isWhite:!1}),a=Object(o.a)(t,2),r=a[0],s=a[1],i=Object(n.useState)({}),l=Object(o.a)(i,2),m=l[0],u=l[1],p=Object(n.useRef)();Object(n.useEffect)(function(){U().then(function(e){u(e)});var e=setInterval(function(){U().then(function(e){e?(u(e),s({isWhite:!1})):s({isWhite:!0})})},5e3);return p.current=e,function(){console.log(123),clearInterval(p.current)}},[]);return c.a.createElement("div",null,r.isWhite?c.a.createElement(c.a.Fragment,null,c.a.createElement(H,{player:e}),c.a.createElement("div",{className:"doll"},"\u0416\u0434\u0435\u043c \u0445\u043e\u0434 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430")):c.a.createElement(c.a.Fragment,null,m.user1?c.a.createElement("div",null,m.user1.id===e.id?c.a.createElement("div",null,c.a.createElement(H,{player:m.user1}),c.a.createElement(H,{player:m.user2,target:!0})):c.a.createElement("div",null,c.a.createElement(H,{player:m.user2}),c.a.createElement(H,{player:m.user1,target:!0})),c.a.createElement("div",{className:"hotKeyPanel"},c.a.createElement("span",{className:"key",onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles/attack"),{},e).then(function(e){return e.data})})().then(function(e){s({isWhite:!0})})}},c.a.createElement("img",{src:"/assets/skills/might.png",alt:"Attack"})),c.a.createElement("span",{className:"key"}),c.a.createElement("span",{className:"key"}),c.a.createElement("span",{className:"key"}),c.a.createElement("span",{className:"key"}))):null))}),X=(a(121),function(e){var t=e.item,a=e.targetItem;return t.id?c.a.createElement("div",{className:"shopSlot",onClick:function(t){console.log(t),e.selectItem(t)}.bind(null,t)},c.a.createElement("div",{className:a===t.id?"itemFrame selected":"itemFrame"}),c.a.createElement("img",{src:"/assets/items"+t.icon,alt:t.name})):c.a.createElement("div",{className:"shopSlot"},c.a.createElement("img",{src:"/assets/items/inventory/free_slot.png",alt:"free slot"}))}),Y=function(){var e=Object(n.useContext)(g).player,t=Object(n.useState)(),a=Object(o.a)(t,2),r=a[0],s=a[1],i=Object(n.useState)({isLoading:!0,showItemInfo:!1,selectItem:{}}),l=Object(o.a)(i,2),m=l[0],u=l[1];Object(n.useEffect)(function(){(function(e){var t={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/shops/location/").concat(e),t).then(function(e){return e.data})})(e.location_id).then(function(e){s(e),u(Object(k.a)({},m,{isLoading:!1}))})},[]);var p,h=function(e){u({showItemInfo:!0,selectItem:e})},d=[];if(!m.isLoading){r.items.map(function(e,t){return d[t]=e});for(var f=0;f<(p=r.items.length,6*Math.ceil(p/6)-p);f++)d.push(0)}return m.isLoading?c.a.createElement("div",null,"2"):c.a.createElement("div",{className:"shop"},c.a.createElement("div",{className:"shopName"},r.name),c.a.createElement("div",{className:"shopList"},d.map(function(e,t){return c.a.createElement(X,{selectItem:h.bind(void 0),key:t,item:e,targetItem:m.selectItem.id})})),m.showItemInfo?c.a.createElement("div",{className:"shopItemInfo"},c.a.createElement("div",{className:"shopItemIcon"},c.a.createElement("img",{src:"/assets/items"+m.selectItem.icon,alt:m.selectItem.name})),c.a.createElement("div",{className:"shopItemDesc"},c.a.createElement("div",{className:"name"},m.selectItem.name),c.a.createElement("div",{className:"stat"},"physical attack:"," ",c.a.createElement("span",{className:"value"},m.selectItem.p_atk)),c.a.createElement("div",{className:"price"},"price: ",c.a.createElement("span",{className:"value"},m.selectItem.price))),c.a.createElement("div",{className:"shopItemBuy",onClick:function(e,t){console.log(e)}.bind(null,m.selectItem.id,e.id)},"Buy")):null)},$=(a(123),function(){var e,t=Object(n.useContext)(g).player;return t.location&&(e=t.location.type),c.a.createElement("div",null,c.a.createElement(z,null),t.in_battle?c.a.createElement("div",{className:"battleground"},c.a.createElement(Q,null)):c.a.createElement("div",{className:"playground"},c.a.createElement(H,{player:t}),c.a.createElement(D,null),"arena"===e?c.a.createElement(J,null):null,"shop"===e?c.a.createElement(Y,null):null,c.a.createElement(R,null)),c.a.createElement(W,null))}),q=function(e){var t=e.component,a=Object(i.a)(e,["component"]),r=Object(n.useContext)(d).auth.isAuth;return c.a.createElement(m.a,Object.assign({},a,{render:function(e){return r?c.a.createElement(t,e):c.a.createElement(u.a,{to:{pathname:"/",state:{from:e.location}}})}}))},V=function(){var e=Object(n.useState)({isAuth:!1}),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)([]),i=Object(o.a)(s,2),u=i[0],p=i[1];return Object(n.useEffect)(function(){r({isAuth:b()}),b()&&j().then(function(e){return p(e)}).catch(function(e){return console.log(e)})},[]),c.a.createElement(l.a,{history:h},c.a.createElement(d.Provider,{value:{auth:a,setAuth:r}},c.a.createElement(g.Provider,{value:{player:u,setPlayer:p}},c.a.createElement(m.a,{exact:!0,path:"/",component:A}),c.a.createElement(m.a,{path:"/register",component:C}),c.a.createElement(q,{path:"/game",component:$}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},36:function(e,t,a){e.exports=a(125)},42:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){},70:function(e,t,a){}},[[36,2,1]]]);
//# sourceMappingURL=main.adcca3d3.chunk.js.map