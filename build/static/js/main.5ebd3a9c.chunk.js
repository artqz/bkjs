(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){},111:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){},117:function(e,t,a){},119:function(e,t,a){},121:function(e,t,a){},123:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(32),s=a.n(c),i=(a(42),a(35)),o=a(2),l=a(127),m=a(126),u=a(125),p=a(9),h=Object(p.a)(),g=Object(n.createContext)({}),d=Object(n.createContext)({}),f=a(3),v=a.n(f),E=function(e){return localStorage.setItem("token",e)},b=function(){return!!j()},j=function(){return localStorage.getItem("token")},N=function(){var e={headers:{Authorization:"Bearer "+y(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/user"),e).then(function(e){return e.data}).catch(function(e){return O()})},y=function(){return localStorage.getItem("token")},O=function(){return localStorage.removeItem("token")},w=(a(63),a(10)),k=a(7),A=a(124),C=(a(65),function(){var e=Object(n.useContext)(g),t=e.setAuth,a=e.auth.isAuth,c=Object(n.useContext)(d).setPlayer,s=Object(n.useState)({username:"",password:""}),i=Object(o.a)(s,2),l=i[0],m=i[1],p=function(e){m(Object(k.a)({},l,Object(w.a)({},e.target.name,e.target.value)))};return a?r.a.createElement(u.a,{to:"/game"}):r.a.createElement("div",{className:"loginBackground"},r.a.createElement("div",{className:"loginForm"},r.a.createElement("input",{name:"username",className:"input",value:l.username,onChange:p}),r.a.createElement("input",{name:"password",type:"password",className:"input",value:l.password,onChange:p}),r.a.createElement("div",{className:"button",onClick:function(){(function(e,t){var a={grant_type:"password",client_id:"2",client_secret:"YuMGy00bQjOewsIS2A9XNnvkkReoLNTpHWipAn3a",username:e,password:t};return v.a.post("".concat("http://82.202.212.131:8000","/oauth/token"),a).then(function(e){return E(e.data.access_token),e})})(l.username,l.password).then(function(e){N().then(function(e){t({isAuth:!0}),c(e),h.push("/game")})})}},"Login"),r.a.createElement(A.a,{to:"/register"},"Register")))}),_=(a(70),function(){var e=Object(n.useContext)(g),t=(e.setAuth,e.auth.isAuth),a=Object(n.useState)({username:"",email:"",password:""}),c=Object(o.a)(a,2),s=c[0],i=c[1],l=function(e){i(Object(k.a)({},s,Object(w.a)({},e.target.name,e.target.value)))};return t?r.a.createElement(u.a,{to:"/game"}):r.a.createElement("div",{className:"registerBackground"},r.a.createElement("div",{className:"registerForm"},r.a.createElement("input",{name:"email",className:"input",value:s.email,onChange:l}),r.a.createElement("input",{name:"username",className:"input",value:s.username,onChange:l}),r.a.createElement("input",{name:"password",type:"password",className:"input",value:s.password,onChange:l}),r.a.createElement("div",{className:"button",onClick:function(){console.log(s),function(e,t,a){var n={email:e,username:t,password:a};return v.a.post("".concat("http://82.202.212.131:8000","/api/users"),n).then(function(e){return e})}(s.email,s.username,s.password).then(function(e){h.push("/")})}},"Register"),r.a.createElement(A.a,{to:"/"},"Login")))}),x=a(33),L=a.n(x),S=a(34),B=a.n(S),I=function(){return localStorage.getItem("token")},K=(a(107),function(e){var t=e.user;return r.a.createElement("div",{className:"user"},r.a.createElement("span",{className:"circle"}),r.a.createElement("span",{className:"username"},t.name),r.a.createElement("span",{className:"level"},"[",t.level,"]"))}),P=[{name:"4Head",src:"assets/emotes/twitch/4head.0"},{name:"Kappa",src:"assets/emotes/twitch/Kappa.0"},{name:"OMEGALUL",src:"assets/emotes/twitch/OMEGALUL.0"},{name:"chompy",src:"assets/emotes/twitch/chompy.gif"},{name:"DatSheffy",src:"assets/emotes/twitch/DatSheffy.0"},{name:"KappaClaus",src:"assets/emotes/twitch/KappaClaus.0"},{name:"KappaPride",src:"assets/emotes/twitch/KappaPride.0"},{name:"KKomrade",src:"assets/emotes/twitch/KKomrade.png"},{name:"KKona",src:"assets/emotes/twitch/KKona.0"},{name:"LUL",src:"assets/emotes/twitch/LUL.0"},{name:"MingLee",src:"assets/emotes/twitch/MingLee.0"},{name:"PogChamp",src:"assets/emotes/twitch/PogChamp.0"},{name:"WutFace",src:"assets/emotes/twitch/WutFace.0"}],W=function(e){var t=e.message,a=t.text.split(" ").map(function(e,t){var a=[];return P.map(function(t){return t.name===e?a=t:null}),a.name===e?r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("img",{alt:e,src:a.src})," "):r.a.createElement(r.a.Fragment,{key:t},e," ")});return r.a.createElement("div",{className:"message"},r.a.createElement("span",{className:"date"},L()(t.date).format("HH:mm")),r.a.createElement("span",{className:"username"},t.is_system?"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435":t.sender.name,":"),r.a.createElement("span",{className:"text"},a))},z=function(){var e=Object(n.useState)({isLoading:!0}),t=Object(o.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)([]),i=Object(o.a)(s,2),l=i[0],m=i[1],u=Object(n.useState)([]),p=Object(o.a)(u,2),h=p[0],g=p[1],d=Object(n.useState)({text:""}),f=Object(o.a)(d,2),E=f[0],b=f[1],j=Object(n.useRef)();return Object(n.useEffect)(function(){var e=setInterval(function(){(function(){var e={headers:{Authorization:"Bearer "+I(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat"),e).then(function(e){return e.data})})().then(function(e){g(e),c({isLoading:!1})}),function(){var e={headers:{Authorization:"Bearer "+I(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat/users_online"),e).then(function(e){return e.data})}().then(function(e){m(e)})},1e3);return j.current=e,function(){clearInterval(j.current)}},[]),r.a.createElement("div",{className:"chat"},a.isLoading?r.a.createElement("div",{className:"loading"},"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{className:"messages"},h?h.map(function(e,t){return r.a.createElement(W,{key:t,message:e})}):null),r.a.createElement("div",{className:"users"},r.a.createElement("div",{className:"online"},"\u041e\u043d\u043b\u0430\u0439\u043d: ",l.length),l?l.map(function(e,t){return r.a.createElement(K,{key:t,user:e})}):null),r.a.createElement("div",null,r.a.createElement("div",{className:"inputBox"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e){var t={message:e},a={headers:{Authorization:"Bearer "+I(),Accept:"application/json"}};v.a.post("".concat("http://82.202.212.131:8000","/api/chat"),t,a).then(function(e){return e.data})}(E.text),b({text:""})}},r.a.createElement("input",{name:"text",className:"input",autoComplete:"off",value:E.text,onChange:function(e){b({text:e.target.value})}}))),r.a.createElement("div",{className:"buttonBox"}))))},F=(a(109),function(){var e,t=Object(n.useContext)(g).setAuth,a=Object(n.useContext)(d),c=a.player,s=a.setPlayer,i=Object(n.useRef)(),o=c.hp_current/c.hp_max*100;e=o<=19?"red":o<=45?"yellow":"green",Object(n.useEffect)(function(){var e=setInterval(function(){N().then(function(e){s(Object(k.a)({},c,{hp_current:e.hp_current,in_battle:e.in_battle}))})},3e3);return i.current=e,function(){clearInterval(i.current)}});return r.a.createElement("div",{className:"topBar"},r.a.createElement("div",{className:"player"},c.name," [",c.level,"]",r.a.createElement("div",{className:"hp","data-progress":c.hp_current+"/"+c.hp_max},r.a.createElement("span",{className:"current",style:{width:o+"%",backgroundColor:e}}))),r.a.createElement("div",null,"Wins: ",c.count_wins),r.a.createElement("div",null,"Loses: ",c.count_loses),r.a.createElement("div",null,r.a.createElement("a",{href:"/",onClick:function(){localStorage.removeItem("token"),t({auth:!1})}},"Logout")))}),R=(a(111),function(){return r.a.createElement("div",{className:"gameMenu"},"map")}),M=(a(113),function(e){var t=e.slot;return r.a.createElement("div",{className:t.className},r.a.createElement("img",{src:t.image,alt:t.name}))}),H=function(e){var t,a=e.player,n=e.target,c=a.hp_current/a.hp_max*100;t=c<=19?"red":c<=45?"yellow":"green";var s="/assets/items/",i=[{name:"helmet",className:"item itemHelmet",image:s+"/inventory/helmet.png",item:[]},{name:"armor",className:"item itemArmor",image:s+"/inventory/armor.png",item:[]},{name:"belt",className:"item itemBelt",image:s+"/inventory/belt.png",item:[]},{name:"pants",className:"item itemPants",image:s+"/inventory/pants.png",item:[]},{name:"main_hand",className:"item itemWeapon",image:s+"/inventory/main_hand.png",item:[]},{name:"off_hand",className:"item itemSubWeapon",image:s+"/inventory/off_hand.png",item:[]},{name:"gloves",className:"item itemGloves",image:s+"/inventory/gloves.png",item:[]},{name:"shoes",className:"item itemShoes",image:s+"/inventory/shoes.png",item:[]},{name:"earringOne",className:"item itemEarringOne",image:s+"/inventory/earring.png",item:[]},{name:"earringTwo",className:"item itemEarringTwo",image:s+"/inventory/earring.png",item:[]},{name:"ringOne",className:"item itemRingOne",image:s+"/inventory/ring.png",item:[]},{name:"ringTwo",className:"item itemRingTwo",image:s+"/inventory/ring.png",item:[]},{name:"necklace",className:"item itemNecklace",image:s+"/inventory/necklace.png",item:[]},{name:"bag",className:"item itemBag",image:s+"/inventory/bag.png",item:[]}];return r.a.createElement("div",{className:n?"character target":"character user"},r.a.createElement("div",null,a.name," [",a.level,"]"),r.a.createElement("div",{className:"hp","data-progress":a.hp_current+"/"+a.hp_max},r.a.createElement("span",{className:"current",style:{width:c+"%",backgroundColor:t}})),r.a.createElement("div",{className:"avatar"},r.a.createElement("img",{src:"/assets/avatars/"+a.avatar,alt:a.name})),r.a.createElement("div",{className:"slots"},i.map(function(e,t){return r.a.createElement(M,{key:t,slot:e})})))},T=(a(115),function(e){var t=e.room;return r.a.createElement("div",{className:"room",style:{left:t.x,top:t.y}},r.a.createElement("img",{src:"/assets/cities"+t.model,alt:t.name,onClick:e.changeLocation.bind(null,t.id)}))}),G=function(){var e=Object(n.useContext)(d),t=e.player,a=e.setPlayer,c=Object(n.useState)({background:null,width:500,height:268,isLoading:!0}),s=Object(o.a)(c,2),i=s[0],l=s[1],m=Object(n.useState)({}),u=Object(o.a)(m,2),p=u[0],h=u[1];Object(n.useEffect)(function(){t.location_id&&function(e){var t={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/locations/").concat(e),t).then(function(e){return e.data})}(t.location_id).then(function(e){h(e),l(Object(k.a)({},i,{isLoading:!1,exitButton:{}}))})},[t.location_id]);var g=p.rooms,f=function(e){(function(e,t){var a={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.put("http://127.0.0.1:8000/api/users/".concat(e,"?update=location"),{location_id:t},a).then(function(e){return e.data})})(t.id,e).then(function(e){a(Object(k.a)({},t,{location_id:e.location_id}))})};return r.a.createElement("div",{className:"map",style:{width:i.width,height:i.height,backgroundImage:"url(/assets/cities"+p.background+")"}},p.location_id?r.a.createElement("div",{onClick:f.bind(null,1)},"Back"):null,i.isLoading?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",{className:"location"},p.name,g?g.map(function(e,t){return r.a.createElement(T,{key:t,room:e,changeLocation:f})}):null))},U=function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles"),e).then(function(e){return e.data})},D=function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles/current"),e).then(function(e){return console.log(e),e.data})},J=(a(117),function(){var e=Object(n.useContext)(d),t=e.player,a=e.setPlayer,c=Object(n.useState)([]),s=Object(o.a)(c,2),i=s[0],l=s[1],m=Object(n.useRef)();Object(n.useEffect)(function(){U().then(function(e){l(e)});var e=setInterval(function(){U().then(function(e){l(e)})},5e3);return m.current=e,function(){clearInterval(m.current)}},[i]);var u=function(e){(function(e){var t={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.put("".concat("http://82.202.212.131:8000","/api/battles/").concat(e),{},t).then(function(e){return e.data})})(e).then(function(e){a(Object(k.a)({},t,{in_battle:!0}))})};return r.a.createElement("div",{className:"fights"},i?i.map(function(e,a){return r.a.createElement("div",{key:a},e.id," - ",e.user1.name," [",e.user1.level,"]"," ",e.user1.id===t.id?null:r.a.createElement("button",{onClick:u.bind(null,e.id)},"Fight"))}):null,r.a.createElement("button",{onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles"),{},e).then(function(e){return e.data})})().then(function(e){return console.log(e)})}},"Fight"))}),Q=(a(119),function(){var e=Object(n.useContext)(d).player,t=Object(n.useState)({isWhite:!1}),a=Object(o.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)({}),l=Object(o.a)(i,2),m=l[0],u=l[1],p=Object(n.useRef)();Object(n.useEffect)(function(){D().then(function(e){u(e)});var e=setInterval(function(){D().then(function(e){e?(u(e),s({isWhite:!1})):s({isWhite:!0})})},5e3);return p.current=e,function(){console.log(123),clearInterval(p.current)}},[]);return r.a.createElement("div",null,c.isWhite?r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{player:e}),r.a.createElement("div",{className:"doll"},"\u0416\u0434\u0435\u043c \u0445\u043e\u0434 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430")):r.a.createElement(r.a.Fragment,null,m.user1?r.a.createElement("div",null,m.user1.id===e.id?r.a.createElement("div",null,r.a.createElement(H,{player:m.user1}),r.a.createElement(H,{player:m.user2,target:!0})):r.a.createElement("div",null,r.a.createElement(H,{player:m.user2}),r.a.createElement(H,{player:m.user1,target:!0})),r.a.createElement("div",{className:"hotKeyPanel"},r.a.createElement("span",{className:"key",onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles/attack"),{},e).then(function(e){return e.data})})().then(function(e){s({isWhite:!0})})}},r.a.createElement("img",{src:"/assets/skills/might.png",alt:"Attack"})),r.a.createElement("span",{className:"key"}),r.a.createElement("span",{className:"key"}),r.a.createElement("span",{className:"key"}),r.a.createElement("span",{className:"key"}))):null))}),X=(a(121),function(){var e=Object(n.useContext)(d).player;return r.a.createElement("div",null,r.a.createElement(F,null),e.in_battle?r.a.createElement("div",{className:"battleground"},r.a.createElement(Q,null)):r.a.createElement("div",{className:"playground"},r.a.createElement(H,{player:e}),r.a.createElement(G,null),r.a.createElement(J,null),r.a.createElement(R,null)),r.a.createElement(z,null))}),Y=function(e){var t=e.component,a=Object(i.a)(e,["component"]),c=Object(n.useContext)(g).auth.isAuth;return r.a.createElement(m.a,Object.assign({},a,{render:function(e){return c?r.a.createElement(t,e):r.a.createElement(u.a,{to:{pathname:"/",state:{from:e.location}}})}}))},$=function(){var e=Object(n.useState)({isAuth:!1}),t=Object(o.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)([]),i=Object(o.a)(s,2),u=i[0],p=i[1];return Object(n.useEffect)(function(){c({isAuth:b()}),b()&&N().then(function(e){return p(e)}).catch(function(e){return console.log(e)})},[]),r.a.createElement(l.a,{history:h},r.a.createElement(g.Provider,{value:{auth:a,setAuth:c}},r.a.createElement(d.Provider,{value:{player:u,setPlayer:p}},r.a.createElement(m.a,{exact:!0,path:"/",component:C}),r.a.createElement(m.a,{path:"/register",component:_}),r.a.createElement(Y,{path:"/game",component:X}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},36:function(e,t,a){e.exports=a(123)},42:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){},70:function(e,t,a){}},[[36,2,1]]]);
//# sourceMappingURL=main.5ebd3a9c.chunk.js.map