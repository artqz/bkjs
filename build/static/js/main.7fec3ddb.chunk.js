(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){},111:function(e,t,a){},113:function(e,t,a){},115:function(e,t,a){},117:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(32),i=a.n(c),o=(a(42),a(35)),s=a(2),l=a(121),u=a(120),m=a(119),p=a(9),h=Object(p.a)(),g=Object(n.createContext)({}),f=Object(n.createContext)({}),d=a(3),v=a.n(d),E=function(e){return localStorage.setItem("token",e)},b=function(){return!!j()},j=function(){return localStorage.getItem("token")},O=function(){var e={headers:{Authorization:"Bearer "+N(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/user"),e).then(function(e){return e.data}).catch(function(e){return y()})},N=function(){return localStorage.getItem("token")},y=function(){return localStorage.removeItem("token")},w=(a(63),a(10)),k=a(7),A=a(118),C=(a(65),function(){var e=Object(n.useContext)(g),t=e.setAuth,a=e.auth.isAuth,c=Object(n.useContext)(f).setPlayer,i=Object(n.useState)({username:"",password:""}),o=Object(s.a)(i,2),l=o[0],u=o[1],p=function(e){u(Object(k.a)({},l,Object(w.a)({},e.target.name,e.target.value)))};return a?r.a.createElement(m.a,{to:"/game"}):r.a.createElement("div",{className:"loginBackground"},r.a.createElement("div",{className:"loginForm"},r.a.createElement("input",{name:"username",className:"input",value:l.username,onChange:p}),r.a.createElement("input",{name:"password",type:"password",className:"input",value:l.password,onChange:p}),r.a.createElement("div",{className:"button",onClick:function(){(function(e,t){var a={grant_type:"password",client_id:"2",client_secret:"YuMGy00bQjOewsIS2A9XNnvkkReoLNTpHWipAn3a",username:e,password:t};return v.a.post("".concat("http://82.202.212.131:8000","/oauth/token"),a).then(function(e){return E(e.data.access_token),e})})(l.username,l.password).then(function(e){O().then(function(e){t({isAuth:!0}),c(e),h.push("/game")})})}},"Login"),r.a.createElement(A.a,{to:"/register"},"Register")))}),x=(a(70),function(){var e=Object(n.useContext)(g),t=(e.setAuth,e.auth.isAuth),a=Object(n.useState)({username:"",email:"",password:""}),c=Object(s.a)(a,2),i=c[0],o=c[1],l=function(e){o(Object(k.a)({},i,Object(w.a)({},e.target.name,e.target.value)))};return t?r.a.createElement(m.a,{to:"/game"}):r.a.createElement("div",{className:"registerBackground"},r.a.createElement("div",{className:"registerForm"},r.a.createElement("input",{name:"email",className:"input",value:i.email,onChange:l}),r.a.createElement("input",{name:"username",className:"input",value:i.username,onChange:l}),r.a.createElement("input",{name:"password",type:"password",className:"input",value:i.password,onChange:l}),r.a.createElement("div",{className:"button",onClick:function(){console.log(i),function(e,t,a){var n={email:e,username:t,password:a};return v.a.post("".concat("http://82.202.212.131:8000","/api/users"),n).then(function(e){return e})}(i.email,i.username,i.password).then(function(e){h.push("/")})}},"Register"),r.a.createElement(A.a,{to:"/"},"Login")))}),_=a(33),S=a.n(_),L=a(34),B=a.n(L),I=function(e){var t={message:e},a={headers:{Authorization:"Bearer "+K(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/chat"),t,a).then(function(e){return e.data})},K=function(){return localStorage.getItem("token")},P=(a(107),function(e){var t=e.user;return r.a.createElement("div",{className:"user"},r.a.createElement("span",{className:"circle"}),r.a.createElement("span",{className:"username"},t.name),r.a.createElement("span",{className:"level"},"[",t.level,"]"))}),W=[{name:"4Head",src:"assets/emotes/twitch/4head.0"},{name:"Kappa",src:"assets/emotes/twitch/Kappa.0"},{name:"OMEGALUL",src:"assets/emotes/twitch/OMEGALUL.0"},{name:"chompy",src:"assets/emotes/twitch/chompy.gif"},{name:"DatSheffy",src:"assets/emotes/twitch/DatSheffy.0"},{name:"KappaClaus",src:"assets/emotes/twitch/KappaClaus.0"},{name:"KappaPride",src:"assets/emotes/twitch/KappaPride.0"},{name:"KKomrade",src:"assets/emotes/twitch/KKomrade.png"},{name:"KKona",src:"assets/emotes/twitch/KKona.0"},{name:"LUL",src:"assets/emotes/twitch/LUL.0"},{name:"MingLee",src:"assets/emotes/twitch/MingLee.0"},{name:"PogChamp",src:"assets/emotes/twitch/PogChamp.0"},{name:"WutFace",src:"assets/emotes/twitch/WutFace.0"}],z=function(e){var t=e.message,a=t.text.split(" ").map(function(e,t){var a=[];return W.map(function(t){return t.name===e?a=t:null}),a.name===e?r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("img",{alt:e,src:a.src})," "):r.a.createElement(r.a.Fragment,{key:t},e," ")});return r.a.createElement("div",{className:"message"},r.a.createElement("span",{className:"date"},S()(t.date).format("HH:mm")),r.a.createElement("span",{className:"username"},t.user.name,":"),r.a.createElement("span",{className:"text"},a))},F=function(){var e=Object(n.useState)({isLoading:!0}),t=Object(s.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)([]),o=Object(s.a)(i,2),l=o[0],u=o[1],m=Object(n.useState)([]),p=Object(s.a)(m,2),h=p[0],g=p[1],f=Object(n.useState)({text:""}),d=Object(s.a)(f,2),E=d[0],b=d[1],j=Object(n.useRef)();return Object(n.useEffect)(function(){var e=setInterval(function(){(function(){var e={headers:{Authorization:"Bearer "+K(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat"),e).then(function(e){return e.data})})().then(function(e){g(e),c({isLoading:!1})}),function(){var e={headers:{Authorization:"Bearer "+K(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/chat/users_online"),e).then(function(e){return e.data})}().then(function(e){u(e)})},1e3);return j.current=e,function(){clearInterval(j.current)}},[]),r.a.createElement("div",{className:"chat"},a.isLoading?r.a.createElement("div",{className:"loading"},"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{className:"messages"},h?h.map(function(e,t){return r.a.createElement(z,{key:t,message:e})}):null),r.a.createElement("div",{className:"users"},r.a.createElement("div",{className:"online"},"\u041e\u043d\u043b\u0430\u0439\u043d: ",l.length),l?l.map(function(e,t){return r.a.createElement(P,{key:t,user:e})}):null),r.a.createElement("div",null,r.a.createElement("div",{className:"inputBox"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),I(E.text),b({text:""})}},r.a.createElement("input",{name:"text",className:"input",autoComplete:"off",value:E.text,onChange:function(e){b({text:e.target.value})}}))),r.a.createElement("div",{className:"buttonBox"}))))},R=(a(109),function(){var e,t=Object(n.useContext)(g).setAuth,a=Object(n.useContext)(f),c=a.player,i=a.setPlayer,o=Object(n.useRef)(),s=c.hp_current/c.hp_max*100;e=s<=19?"red":s<=45?"yellow":"green",Object(n.useEffect)(function(){var e=setInterval(function(){O().then(function(e){i(Object(k.a)({},c,{hp_current:e.hp_current,in_battle:e.in_battle}))})},3e3);return o.current=e,function(){clearInterval(o.current)}});return r.a.createElement("div",{className:"topBar"},r.a.createElement("div",{className:"player"},c.name," [",c.level,"]",r.a.createElement("div",{className:"hp","data-progress":c.hp_current+"/"+c.hp_max},r.a.createElement("span",{className:"current",style:{width:s+"%",backgroundColor:e}}))),r.a.createElement("div",null,r.a.createElement("a",{href:"/",onClick:function(){localStorage.removeItem("token"),t({auth:!1})}},"Logout")))}),H=(a(111),function(e){var t=e.slot;return r.a.createElement("div",{className:t.className},r.a.createElement("img",{src:t.image,alt:t.name}))}),M=function(e){var t=e.player,a="/assets/items/",n=[{name:"helmet",className:"item itemHelmet",image:a+"/inventory/helmet.png",item:[]},{name:"armor",className:"item itemArmor",image:a+"/inventory/armor.png",item:[]},{name:"belt",className:"item itemBelt",image:a+"/inventory/belt.png",item:[]},{name:"pants",className:"item itemPants",image:a+"/inventory/pants.png",item:[]},{name:"main_hand",className:"item itemWeapon",image:a+"/inventory/main_hand.png",item:[]},{name:"off_hand",className:"item itemSubWeapon",image:a+"/inventory/off_hand.png",item:[]},{name:"gloves",className:"item itemGloves",image:a+"/inventory/gloves.png",item:[]},{name:"shoes",className:"item itemShoes",image:a+"/inventory/shoes.png",item:[]},{name:"earringOne",className:"item itemEarringOne",image:a+"/inventory/earring.png",item:[]},{name:"earringTwo",className:"item itemEarringTwo",image:a+"/inventory/earring.png",item:[]},{name:"ringOne",className:"item itemRingOne",image:a+"/inventory/ring.png",item:[]},{name:"ringTwo",className:"item itemRingTwo",image:a+"/inventory/ring.png",item:[]},{name:"necklace",className:"item itemNecklace",image:a+"/inventory/necklace.png",item:[]},{name:"bag",className:"item itemBag",image:a+"/inventory/bag.png",item:[]}];return r.a.createElement("div",{className:"character"},r.a.createElement("div",null,t.name," - ",t.hp_current),r.a.createElement("div",{className:"avatar"},r.a.createElement("img",{src:"/assets/avatars/"+t.avatar,alt:t.name})),r.a.createElement("div",{className:"slots"},n.map(function(e,t){return r.a.createElement(H,{key:t,slot:e})})))},T=(a(113),function(e){var t=e.room;return r.a.createElement("div",{className:"room",style:{left:t.x,top:t.y}},r.a.createElement("img",{src:"/assets/cities"+t.model,alt:t.name,onClick:e.changeLocation.bind(null,t.id)}))}),U=function(){var e=Object(n.useContext)(f),t=e.player,a=e.setPlayer,c=Object(n.useState)({background:null,width:500,height:268,isLoading:!0}),i=Object(s.a)(c,2),o=i[0],l=i[1],u=Object(n.useState)({}),m=Object(s.a)(u,2),p=m[0],h=m[1];Object(n.useEffect)(function(){t.location_id&&function(e){var t={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/locations/").concat(e),t).then(function(e){return e.data})}(t.location_id).then(function(e){h(e),l(Object(k.a)({},o,{isLoading:!1,exitButton:{}}))})},[t.location_id]);var g=p.rooms,d=function(e){(function(e,t){var a={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.put("http://127.0.0.1:8000/api/users/".concat(e,"?update=location"),{location_id:t},a).then(function(e){return e.data})})(t.id,e).then(function(e){a(Object(k.a)({},t,{location_id:e.location_id}))})};return r.a.createElement("div",{className:"map",style:{width:o.width,height:o.height,backgroundImage:"url(/assets/cities"+p.background+")"}},p.location_id?r.a.createElement("div",{onClick:d.bind(null,1)},"Back"):null,o.isLoading?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",{className:"location"},p.name,g?g.map(function(e,t){return r.a.createElement(T,{key:t,room:e,changeLocation:d})}):null))},G=function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles/current"),e).then(function(e){return console.log(e),e.data})},D=(a(115),function(){var e=Object(n.useContext)(f),t=e.player,a=e.setPlayer,c=Object(n.useState)([]),i=Object(s.a)(c,2),o=i[0],l=i[1],u=Object(n.useRef)();Object(n.useEffect)(function(){var e=setInterval(function(){(function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.get("".concat("http://82.202.212.131:8000","/api/battles"),e).then(function(e){return e.data})})().then(function(e){l(e)})},5e3);return u.current=e,function(){clearInterval(u.current)}},[o]);var m=function(e){(function(e){var t={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.put("".concat("http://82.202.212.131:8000","/api/battles/").concat(e),{},t).then(function(e){return e.data})})(e).then(function(e){a(Object(k.a)({},t,{in_battle:!0}))})};return r.a.createElement("div",{className:"fights"},o?o.map(function(e,a){return r.a.createElement("div",{key:a},e.id," - ",e.user1.name," [",e.user1.level,"]"," ",e.user1.id===t.id?null:r.a.createElement("button",{onClick:m.bind(null,e.id)},"Fight"))}):null,r.a.createElement("button",{onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles"),{},e).then(function(e){return e.data})})().then(function(e){return console.log(e)}),I("<--- \u042d\u0442\u043e\u0442 \u0443\u0435\u0431\u043e\u043a \u043f\u043e\u0434\u0430\u043b \u0437\u0430\u044f\u0432\u043a\u0443 \u043d\u0430 \u0431\u043e\u0439!")}},"Fight"))}),J=function(){var e=Object(n.useContext)(f).player,t=Object(n.useState)({isWhite:!1}),a=Object(s.a)(t,2),c=a[0],i=a[1],o=Object(n.useState)({}),l=Object(s.a)(o,2),u=l[0],m=l[1],p=Object(n.useRef)();Object(n.useEffect)(function(){G().then(function(e){m(e)});var e=setInterval(function(){G().then(function(e){e?(m(e),i({isWhite:!1})):i({isWhite:!0})})},5e3);return p.current=e,function(){console.log(123),clearInterval(p.current)}},[]);return r.a.createElement("div",null,c.isWhite?r.a.createElement("span",null,"\u041e\u0436\u0438\u0434\u0430\u0435\u0435\u043c \u0445\u043e\u0434 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430"):r.a.createElement(r.a.Fragment,null,u.user1?r.a.createElement("div",null,u.user1.id===e.id?r.a.createElement("div",null,r.a.createElement(M,{player:u.user1}),r.a.createElement(M,{player:u.user2})):r.a.createElement("div",null,r.a.createElement(M,{player:u.user2}),r.a.createElement(M,{player:u.user1})),r.a.createElement("button",{onClick:function(){(function(){var e={headers:{Authorization:"Bearer "+j(),Accept:"application/json"}};return v.a.post("".concat("http://82.202.212.131:8000","/api/battles/attack"),{},e).then(function(e){return e.data})})().then(function(e){i({isWhite:!0}),console.log(e)})}},"Uebat!"),u.rounds?r.a.createElement("div",{className:"textPvp"},u.rounds.map(function(e,t){return r.a.createElement("div",{key:t},e.text)})):null):null))},Q=function(){var e=Object(n.useContext)(f).player;return r.a.createElement("div",null,r.a.createElement(R,null),e.in_battle?r.a.createElement(J,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{player:e}),r.a.createElement(U,null),r.a.createElement(D,null)),r.a.createElement(F,null))},X=function(e){var t=e.component,a=Object(o.a)(e,["component"]),c=Object(n.useContext)(g).auth.isAuth;return r.a.createElement(u.a,Object.assign({},a,{render:function(e){return c?r.a.createElement(t,e):r.a.createElement(m.a,{to:{pathname:"/",state:{from:e.location}}})}}))},Y=function(){var e=Object(n.useState)({isAuth:!1}),t=Object(s.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)([]),o=Object(s.a)(i,2),m=o[0],p=o[1];return Object(n.useEffect)(function(){c({isAuth:b()}),b()&&O().then(function(e){return p(e)}).catch(function(e){return console.log(e)})},[]),r.a.createElement(l.a,{history:h},r.a.createElement(g.Provider,{value:{auth:a,setAuth:c}},r.a.createElement(f.Provider,{value:{player:m,setPlayer:p}},r.a.createElement(u.a,{exact:!0,path:"/",component:C}),r.a.createElement(u.a,{path:"/register",component:x}),r.a.createElement(X,{path:"/game",component:Q}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},36:function(e,t,a){e.exports=a(117)},42:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){},70:function(e,t,a){}},[[36,2,1]]]);
//# sourceMappingURL=main.7fec3ddb.chunk.js.map